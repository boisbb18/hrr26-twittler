<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
    <link rel = "stylesheet" href ="twstyle.css">
  </head>
  <body bgcolor="#18E1F1">

 <script>

      $(document).ready(function(){
        var $body = $('body');
        var $tweetId = $('<div id= "tweets"></div>');
        var $filtered = $('<div id="filtered"></div>');
        $body.html('');
        var $div = $('<div class ="box">Refresh</div>')
        $div.appendTo('body');
        gettingTweets();
       	 
        function gettingTweets(){
          var index = 0;
        $("#tweets").html('');
        while(index < streams.home.length){
          var tweet = streams.home[index];
          var dateNow = streams.date[index];
          var $tweet = $('<div class ="tweetBox"></div>');
          var $test = $('<div></div>');
          var userName = '<a href=# class="user">' + tweet.user + '</a>'
            $test.html('@' + userName + ': ' + tweet.message).appendTo($('ul'));
          var $timing = $('<span class = "addingTime"></span>');
          var currentTime = new Date().getTime() / 1000;
          var passedTime = tweet.created_at.getTime()/1000;
          var difference = Math.round((currentTime - passedTime)/60);
              if (difference < 60){
               $timing.text(''+ difference + ' minutes ago');
            } else{
              var hour = parseInt(difference/60);
              var minutes = parseInt(difference%60);
              $timing.text(''+ hour + ' hours  ' + minutes + ' ago.');
            }
        
          $timing.appendTo($tweet);
          $test.appendTo($tweet);
          $tweet.appendTo($tweetId);
          index += 1;
        }
         $tweetId.appendTo($body);


        }

         $('.user').click(function(){
          var username = $(this).text()
          var newArray = newArr(username);
          $("#tweets").html('');
          var index = 0;
            while(index < newArray.length){
                var tweet = newArray[index];
              var dateNow = newArray[index].created_at;
              var $tweet = $('<div class ="tweetBox"></div>');
              var $test = $('<div></div>');
              var userName = '<a href=# class="user">' + tweet.user + '</a>'
                $test.html('@' + userName + ': ' + tweet.message).appendTo($('ul'));
              var $timing = $('<span class = "addingTime"></span>');
              var currentTime = new Date().getTime() / 1000;
              var passedTime = tweet.created_at.getTime()/1000;
              var difference = Math.round((currentTime - passedTime)/60);
                  if (difference < 60){
                   $timing.text(''+ difference + ' minutes ago');
                } else{
                  var hour = parseInt(difference/60);
                  var minutes = parseInt(difference%60);
                  $timing.text(''+ hour + ' hours  ' + minutes + ' ago.');
                }
        
          $timing.appendTo($tweet);
          $test.appendTo($tweet);
          $tweet.appendTo($tweetId);
          index += 1;
        }
         $tweetId.appendTo($body);
        });
          $('.box').click(function(){
            gettingTweets();
         }) ;

      });
    </script>

	

  </body>
</html>
